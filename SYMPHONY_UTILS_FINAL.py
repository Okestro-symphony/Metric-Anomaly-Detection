import math
import numpy as np 

import matplotlib.pyplot as plt

import torch
from torch.utils.data import Dataset, DataLoader
from torch.utils.data.sampler import Sampler
from torch.optim.lr_scheduler import _LRScheduler


sustain_col = ['node5_MEM_memtotal', 'node6_MEM_memtotal', 'node7_MEM_memtotal', 'node8_MEM_memtotal', 'streaming_num'+]

trash_col = ['node6_CPU_ALL_Busy',
 'node6_CPU_ALL_CPUs',
 'node6_CPU_ALL_Steal%',
 'node6_MEM_bigfree',
 'node6_MEM_buffers',
 'node6_MEM_highfree',
 'node6_MEM_hightotal',
 'node6_MEM_lowfree',
 'node6_MEM_lowtotal',
 'node6_MEM_memshared',
 'node6_MEM_memtotal',
 'node6_MEM_swapcached',
 'node6_MEM_swapfree',
 'node6_MEM_swaptotal',
 'node6_NET_em2-read-KB/s',
 'node6_NET_em2-write-KB/s',
 'node6_NET_em3-read-KB/s',
 'node6_NET_em3-write-KB/s',
 'node6_NET_em4-read-KB/s',
 'node6_NET_em4-write-KB/s',
 'node6_NET_idrac-read-KB/s',
 'node6_NET_idrac-write-KB/s',
 'node7_CPU_ALL_Busy',
 'node7_CPU_ALL_CPUs',
 'node7_CPU_ALL_Steal%',
 'node7_MEM_bigfree',
 'node7_MEM_buffers',
 'node7_MEM_highfree',
 'node7_MEM_hightotal',
 'node7_MEM_lowfree',
 'node7_MEM_lowtotal',
 'node7_MEM_memshared',
 'node7_MEM_memtotal',
 'node7_MEM_swapcached',
 'node7_MEM_swapfree',
 'node7_MEM_swaptotal',
 'node7_NET_em2-read-KB/s',
 'node7_NET_em2-write-KB/s',
 'node7_NET_em3-read-KB/s',
 'node7_NET_em3-write-KB/s',
 'node7_NET_em4-read-KB/s',
 'node7_NET_em4-write-KB/s',
 'node7_NET_idrac-read-KB/s',
 'node7_NET_idrac-write-KB/s',
 'node8_CPU_ALL_Busy',
 'node8_CPU_ALL_CPUs',
 'node8_CPU_ALL_Steal%',
 'node8_MEM_bigfree',
 'node8_MEM_buffers',
 'node8_MEM_highfree',
 'node8_MEM_hightotal',
 'node8_MEM_lowfree',
 'node8_MEM_lowtotal',
 'node8_MEM_memshared',
 'node8_MEM_memtotal',
 'node8_MEM_swapcached',
 'node8_MEM_swapfree',
 'node8_MEM_swaptotal',
 'node8_NET_em2-read-KB/s',
 'node8_NET_em2-write-KB/s',
 'node8_NET_em3-read-KB/s',
 'node8_NET_em3-write-KB/s',
 'node8_NET_em4-read-KB/s',
 'node8_NET_em4-write-KB/s',
 'node8_NET_idrac-read-KB/s',
 'node8_NET_idrac-write-KB/s',
 'node5_CPU_ALL_Busy',
 'node5_CPU_ALL_CPUs',
 'node5_CPU_ALL_Steal%',
 'node5_MEM_bigfree',
 'node5_MEM_buffers',
 'node5_MEM_highfree',
 'node5_MEM_hightotal',
 'node5_MEM_lowfree',
 'node5_MEM_lowtotal',
 'node5_MEM_memshared',
 'node5_MEM_memtotal',
 'node5_MEM_swapcached',
 'node5_MEM_swapfree',
 'node5_MEM_swaptotal',
 'node5_NET_em2-read-KB/s',
 'node5_NET_em2-write-KB/s',
 'node5_NET_em3-read-KB/s',
 'node5_NET_em3-write-KB/s',
 'node5_NET_em4-read-KB/s',
 'node5_NET_em4-write-KB/s',
 'node5_NET_idrac-read-KB/s',
 'node5_NET_idrac-write-KB/s']

normal_streaming_dict = {'1': {'t': 1525679396.7076304,
  'node6_CPU_ALL_Idle%': 88.14916575591984,
  'node6_CPU_ALL_Sys%': 0.8710698239222828,
  'node6_CPU_ALL_User%': 10.885156041287189,
  'node6_CPU_ALL_Wait%': 0.08315482695810565,
  'node6_MEM_active': 82228.15760291438,
  'node6_MEM_cached': 63393.27974256223,
  'node6_MEM_inactive': 39619.9041505768,
  'node6_MEM_memfree': 637246.4182659381,
  'node6_MEM_memtotal': 772475.0999999999,
  'node6_NET_em1-read-KB/s': 19124.381612629026,
  'node6_NET_em1-write-KB/s': 439.43166241651494,
  'node6_NET_ib0-read-KB/s': 14448.764478445659,
  'node6_NET_ib0-write-KB/s': 24499.010117789923,
  'node6_NET_lo-read-KB/s': 1337.381768063145,
  'node6_NET_lo-write-KB/s': 1337.381768063145,
  'node7_CPU_ALL_Idle%': 92.52703765751329,
  'node7_CPU_ALL_Sys%': 0.5463422924709254,
  'node7_CPU_ALL_User%': 6.799934445334692,
  'node7_CPU_ALL_Wait%': 0.1277417631777017,
  'node7_MEM_active': 69728.743516158,
  'node7_MEM_cached': 41810.866479714474,
  'node7_MEM_inactive': 29277.725126860423,
  'node7_MEM_memfree': 659849.6759608614,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 21587.444147425154,
  'node7_NET_em1-write-KB/s': 416.6747347464006,
  'node7_NET_ib0-read-KB/s': 10063.152154806126,
  'node7_NET_ib0-write-KB/s': 36022.16495981741,
  'node7_NET_lo-read-KB/s': 7636.582450773301,
  'node7_NET_lo-write-KB/s': 7636.582450773301,
  'node8_CPU_ALL_Idle%': 91.57000900703524,
  'node8_CPU_ALL_Sys%': 0.6361936756006719,
  'node8_CPU_ALL_User%': 7.653625940261447,
  'node8_CPU_ALL_Wait%': 0.13624236227756273,
  'node8_MEM_active': 63779.797840745865,
  'node8_MEM_cached': 39014.41236154726,
  'node8_MEM_inactive': 27339.425382798996,
  'node8_MEM_memfree': 668229.3215000365,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 644.2253657586601,
  'node8_NET_em1-write-KB/s': 360.30059397745805,
  'node8_NET_ib0-read-KB/s': 13928.409114145914,
  'node8_NET_ib0-write-KB/s': 13367.62887363373,
  'node8_NET_lo-read-KB/s': 22491.815158596848,
  'node8_NET_lo-write-KB/s': 22491.815158596848,
  'node5_CPU_ALL_Idle%': 91.99899397356143,
  'node5_CPU_ALL_Sys%': 0.6592170489891136,
  'node5_CPU_ALL_User%': 6.901129957231724,
  'node5_CPU_ALL_Wait%': 0.43573823872472783,
  'node5_MEM_active': 58988.255231823474,
  'node5_MEM_cached': 45153.9451083787,
  'node5_MEM_inactive': 32813.25333398134,
  'node5_MEM_memfree': 667423.0069862946,
  'node5_MEM_memtotal': 772475.0999999997,
  'node5_NET_em1-read-KB/s': 7539.688129374027,
  'node5_NET_em1-write-KB/s': 405.31793594479,
  'node5_NET_ib0-read-KB/s': 12111.01023765552,
  'node5_NET_ib0-write-KB/s': 32056.42985274106,
  'node5_NET_lo-read-KB/s': 1032.9168521578538,
  'node5_NET_lo-write-KB/s': 1032.9168521578538,
  'streaming_num': np.inf},
 '2': {'t': 1526139551.7808475,
  'node6_CPU_ALL_Idle%': 95.76485677577598,
  'node6_CPU_ALL_Sys%': 0.3704266067100768,
  'node6_CPU_ALL_User%': 3.7771936227990768,
  'node6_CPU_ALL_Wait%': 0.08402487809151167,
  'node6_MEM_active': 70360.50923730545,
  'node6_MEM_cached': 117008.03955382953,
  'node6_MEM_inactive': 99889.9784039478,
  'node6_MEM_memfree': 584608.7399830641,
  'node6_MEM_memtotal': 772475.0999999997,
  'node6_NET_em1-read-KB/s': 2800.797234794288,
  'node6_NET_em1-write-KB/s': 277.2653079101819,
  'node6_NET_ib0-read-KB/s': 24939.11147837767,
  'node6_NET_ib0-write-KB/s': 22485.76224924811,
  'node6_NET_lo-read-KB/s': 239.58843402341813,
  'node6_NET_lo-write-KB/s': 239.58843402341813,
  'node7_CPU_ALL_Idle%': 93.56364166314471,
  'node7_CPU_ALL_Sys%': 0.48893714385647874,
  'node7_CPU_ALL_User%': 5.796114665461912,
  'node7_CPU_ALL_Wait%': 0.14566069632889808,
  'node7_MEM_active': 83050.08063307927,
  'node7_MEM_cached': 179093.41118818952,
  'node7_MEM_inactive': 156104.94839762742,
  'node7_MEM_memfree': 512378.0019484968,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 24546.18641590277,
  'node7_NET_em1-write-KB/s': 265.03717008904505,
  'node7_NET_ib0-read-KB/s': 34263.6845475611,
  'node7_NET_ib0-write-KB/s': 37529.381545389624,
  'node7_NET_lo-read-KB/s': 293.193481207281,
  'node7_NET_lo-write-KB/s': 293.193481207281,
  'node8_CPU_ALL_Idle%': 91.7391595339817,
  'node8_CPU_ALL_Sys%': 0.4879981335938525,
  'node8_CPU_ALL_User%': 7.673727417214679,
  'node8_CPU_ALL_Wait%': 0.0879952173342471,
  'node8_MEM_active': 100485.4251381578,
  'node8_MEM_cached': 112963.17882503901,
  'node8_MEM_inactive': 87450.66948280136,
  'node8_MEM_memfree': 565856.8796022222,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 66111.29053819572,
  'node8_NET_em1-write-KB/s': 529.1596185532436,
  'node8_NET_ib0-read-KB/s': 16019.114121987139,
  'node8_NET_ib0-write-KB/s': 75240.34248844432,
  'node8_NET_lo-read-KB/s': 287.32586284831075,
  'node8_NET_lo-write-KB/s': 287.32586284831075,
  'node5_CPU_ALL_Idle%': 94.63790223675758,
  'node5_CPU_ALL_Sys%': 0.33930678035390993,
  'node5_CPU_ALL_User%': 4.950086141447177,
  'node5_CPU_ALL_Wait%': 0.06743853296735385,
  'node5_MEM_active': 77267.06373737079,
  'node5_MEM_cached': 85548.43247678562,
  'node5_MEM_inactive': 39031.33462302167,
  'node5_MEM_memfree': 640590.3163318343,
  'node5_MEM_memtotal': 772475.0999999999,
  'node5_NET_em1-read-KB/s': 4728.2778266074865,
  'node5_NET_em1-write-KB/s': 210.61436372131053,
  'node5_NET_ib0-read-KB/s': 24183.66808386381,
  'node5_NET_ib0-write-KB/s': 16668.892288150444,
  'node5_NET_lo-read-KB/s': 320.42124627693744,
  'node5_NET_lo-write-KB/s': 320.42124627693744,
  'streaming_num': np.inf},
 '3': {'t': 1525947878.0869887,
  'node6_CPU_ALL_Idle%': 94.09689278128853,
  'node6_CPU_ALL_Sys%': 0.43641345674804005,
  'node6_CPU_ALL_User%': 5.3059836903794215,
  'node6_CPU_ALL_Wait%': 0.153948483974443,
  'node6_MEM_active': 68701.59764882746,
  'node6_MEM_cached': 62029.257291693975,
  'node6_MEM_inactive': 49897.74680668816,
  'node6_MEM_memfree': 639610.7892781288,
  'node6_MEM_memtotal': 772475.0999999996,
  'node6_NET_em1-read-KB/s': 5570.889051752017,
  'node6_NET_em1-write-KB/s': 221.47831240003146,
  'node6_NET_ib0-read-KB/s': 36975.50190191503,
  'node6_NET_ib0-write-KB/s': 24926.949351897983,
  'node6_NET_lo-read-KB/s': 386.79225511532985,
  'node6_NET_lo-write-KB/s': 386.79225511532985,
  'node7_CPU_ALL_Idle%': 94.26945111567179,
  'node7_CPU_ALL_Sys%': 0.4286380507401424,
  'node7_CPU_ALL_User%': 5.1611423081961485,
  'node7_CPU_ALL_Wait%': 0.13065804986681803,
  'node7_MEM_active': 84336.5953731278,
  'node7_MEM_cached': 61893.89687349898,
  'node7_MEM_inactive': 42704.56344613772,
  'node7_MEM_memfree': 629227.6083507271,
  'node7_MEM_memtotal': 772475.0999999996,
  'node7_NET_em1-read-KB/s': 2904.9803362298603,
  'node7_NET_em1-write-KB/s': 167.3389214444784,
  'node7_NET_ib0-read-KB/s': 39261.13423431292,
  'node7_NET_ib0-write-KB/s': 11968.930637090083,
  'node7_NET_lo-read-KB/s': 273.40720492554914,
  'node7_NET_lo-write-KB/s': 273.40720492554914,
  'node8_CPU_ALL_Idle%': 94.27435238594651,
  'node8_CPU_ALL_Sys%': 0.4176350288411117,
  'node8_CPU_ALL_User%': 5.264598846355532,
  'node8_CPU_ALL_Wait%': 0.043563188253801774,
  'node8_MEM_active': 74302.25799423178,
  'node8_MEM_cached': 30456.616253277403,
  'node8_MEM_inactive': 9985.030370564587,
  'node8_MEM_memfree': 673173.085101381,
  'node8_MEM_memtotal': 772475.1,
  'node8_NET_em1-read-KB/s': 57328.07495280544,
  'node8_NET_em1-write-KB/s': 537.62627337878,
  'node8_NET_ib0-read-KB/s': 5106.873838489775,
  'node8_NET_ib0-write-KB/s': 64403.20733176019,
  'node8_NET_lo-read-KB/s': 438.4833429470373,
  'node8_NET_lo-write-KB/s': 438.4833429470373,
  'node5_CPU_ALL_Idle%': 96.3115330618509,
  'node5_CPU_ALL_Sys%': 0.31615029778773795,
  'node5_CPU_ALL_User%': 3.145788679705962,
  'node5_CPU_ALL_Wait%': 0.21501669878530505,
  'node5_MEM_active': 74606.40996346323,
  'node5_MEM_cached': 123380.33683063157,
  'node5_MEM_inactive': 84911.2967195389,
  'node5_MEM_memfree': 596191.5903007525,
  'node5_MEM_memtotal': 772475.0999999996,
  'node5_NET_em1-read-KB/s': 19166.236882951544,
  'node5_NET_em1-write-KB/s': 281.5025924537187,
  'node5_NET_ib0-read-KB/s': 4240.0987669930855,
  'node5_NET_ib0-write-KB/s': 33588.65602071871,
  'node5_NET_lo-read-KB/s': 188.3461287594067,
  'node5_NET_lo-write-KB/s': 188.3461287594067,
  'streaming_num': np.inf},
 '4': {'t': 1525874037.3201468,
  'node6_CPU_ALL_Idle%': 97.54356182589585,
  'node6_CPU_ALL_Sys%': 0.30803557736543474,
  'node6_CPU_ALL_User%': 2.097613862904462,
  'node6_CPU_ALL_Wait%': 0.05430557685426571,
  'node6_MEM_active': 34841.5003220365,
  'node6_MEM_cached': 7685.8534979297665,
  'node6_MEM_inactive': 4458.366685068752,
  'node6_MEM_memfree': 721672.747623575,
  'node6_MEM_memtotal': 772475.0999999999,
  'node6_NET_em1-read-KB/s': 3614.021981291213,
  'node6_NET_em1-write-KB/s': 220.75842355466952,
  'node6_NET_ib0-read-KB/s': 12743.414789142771,
  'node6_NET_ib0-write-KB/s': 13861.069825691357,
  'node6_NET_lo-read-KB/s': 217.64286868067268,
  'node6_NET_lo-write-KB/s': 217.64286868067268,
  'node7_CPU_ALL_Idle%': 96.59072746407077,
  'node7_CPU_ALL_Sys%': 0.3571011609168942,
  'node7_CPU_ALL_User%': 3.002362942743448,
  'node7_CPU_ALL_Wait%': 0.04511954484164831,
  'node7_MEM_active': 56242.23901404282,
  'node7_MEM_cached': 56186.249512447794,
  'node7_MEM_inactive': 35742.163446739236,
  'node7_MEM_memfree': 664868.5785148159,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 5574.357820567633,
  'node7_NET_em1-write-KB/s': 158.70860410431808,
  'node7_NET_ib0-read-KB/s': 26677.922105107376,
  'node7_NET_ib0-write-KB/s': 21656.544738053733,
  'node7_NET_lo-read-KB/s': 196.89990873811945,
  'node7_NET_lo-write-KB/s': 196.89990873811945,
  'node8_CPU_ALL_Idle%': 95.69621555862435,
  'node8_CPU_ALL_Sys%': 0.382351055434997,
  'node8_CPU_ALL_User%': 3.8679900703623327,
  'node8_CPU_ALL_Wait%': 0.05378444137568225,
  'node8_MEM_active': 61661.111975570464,
  'node8_MEM_cached': 55749.18466495692,
  'node8_MEM_inactive': 35847.16414973367,
  'node8_MEM_memfree': 660749.173781811,
  'node8_MEM_memtotal': 772475.0999999997,
  'node8_NET_em1-read-KB/s': 37390.923525350176,
  'node8_NET_em1-write-KB/s': 433.231910468863,
  'node8_NET_ib0-read-KB/s': 10820.01630745709,
  'node8_NET_ib0-write-KB/s': 54232.30488261986,
  'node8_NET_lo-read-KB/s': 293.92482984809635,
  'node8_NET_lo-write-KB/s': 293.92482984809635,
  'node5_CPU_ALL_Idle%': 97.23991286725796,
  'node5_CPU_ALL_Sys%': 0.2827925141324057,
  'node5_CPU_ALL_User%': 2.432874970258363,
  'node5_CPU_ALL_Wait%': 0.04338012684295595,
  'node5_MEM_active': 66363.60494244478,
  'node5_MEM_cached': 86335.73281425628,
  'node5_MEM_inactive': 48962.05477302003,
  'node5_MEM_memfree': 640957.0219800958,
  'node5_MEM_memtotal': 772475.0999999996,
  'node5_NET_em1-read-KB/s': 14773.598821000467,
  'node5_NET_em1-write-KB/s': 265.27029938547616,
  'node5_NET_ib0-read-KB/s': 12403.827354922345,
  'node5_NET_ib0-write-KB/s': 29517.30385861851,
  'node5_NET_lo-read-KB/s': 97.36080421387723,
  'node5_NET_lo-write-KB/s': 97.36080421387723,
  'streaming_num': np.inf},
 '5': {'t': 1525944778.0879166,
  'node6_CPU_ALL_Idle%': 94.71547460292645,
  'node6_CPU_ALL_Sys%': 0.45997903120487793,
  'node6_CPU_ALL_User%': 4.753034497346713,
  'node6_CPU_ALL_Wait%': 0.07023626681872108,
  'node6_MEM_active': 61273.285831348345,
  'node6_MEM_cached': 64385.285930674225,
  'node6_MEM_inactive': 50035.127344964276,
  'node6_MEM_memfree': 646379.7855664792,
  'node6_MEM_memtotal': 772475.0999999999,
  'node6_NET_em1-read-KB/s': 5475.651968583596,
  'node6_NET_em1-write-KB/s': 287.803477325191,
  'node6_NET_ib0-read-KB/s': 17211.109576669456,
  'node6_NET_ib0-write-KB/s': 19408.828089908307,
  'node6_NET_lo-read-KB/s': 243.05242106812094,
  'node6_NET_lo-write-KB/s': 243.05242106812094,
  'node7_CPU_ALL_Idle%': 94.83298516910834,
  'node7_CPU_ALL_Sys%': 0.4337086272381987,
  'node7_CPU_ALL_User%': 4.443874721167179,
  'node7_CPU_ALL_Wait%': 0.281952734068849,
  'node7_MEM_active': 67382.94495011153,
  'node7_MEM_cached': 205966.5972877856,
  'node7_MEM_inactive': 185256.21317447396,
  'node7_MEM_memfree': 499865.59767136915,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 25501.988989871585,
  'node7_NET_em1-write-KB/s': 303.06475628504245,
  'node7_NET_ib0-read-KB/s': 19325.226183155482,
  'node7_NET_ib0-write-KB/s': 39437.62098631458,
  'node7_NET_lo-read-KB/s': 326.0330725869657,
  'node7_NET_lo-write-KB/s': 326.0330725869657,
  'node8_CPU_ALL_Idle%': 94.27271946349181,
  'node8_CPU_ALL_Sys%': 0.41077914249114617,
  'node8_CPU_ALL_User%': 5.117212719463491,
  'node8_CPU_ALL_Wait%': 0.19318363348654957,
  'node8_MEM_active': 75081.59629944993,
  'node8_MEM_cached': 171410.6679300731,
  'node8_MEM_inactive': 149758.80724888857,
  'node8_MEM_memfree': 529333.8589473288,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 37470.126771908675,
  'node8_NET_em1-write-KB/s': 394.6923042724738,
  'node8_NET_ib0-read-KB/s': 15731.901496496119,
  'node8_NET_ib0-write-KB/s': 52056.50194936327,
  'node8_NET_lo-read-KB/s': 251.43715394469137,
  'node8_NET_lo-write-KB/s': 251.43715394469137,
  'node5_CPU_ALL_Idle%': 95.6003403255681,
  'node5_CPU_ALL_Sys%': 0.31653364856114563,
  'node5_CPU_ALL_User%': 3.9081565196440144,
  'node5_CPU_ALL_Wait%': 0.16966660141250164,
  'node5_MEM_active': 71831.72982516905,
  'node5_MEM_cached': 175928.35491966212,
  'node5_MEM_inactive': 137651.23838601352,
  'node5_MEM_memfree': 544891.7087889832,
  'node5_MEM_memtotal': 772475.0999999996,
  'node5_NET_em1-read-KB/s': 3672.478060294848,
  'node5_NET_em1-write-KB/s': 193.9090005571702,
  'node5_NET_ib0-read-KB/s': 21985.15614091888,
  'node5_NET_ib0-write-KB/s': 16893.507472103844,
  'node5_NET_lo-read-KB/s': 165.55800292137874,
  'node5_NET_lo-write-KB/s': 165.55800292137874,
  'streaming_num': np.inf},
 '6': {'t': 1525973716.5562499,
  'node6_CPU_ALL_Idle%': 92.77309858697114,
  'node6_CPU_ALL_Sys%': 0.5946408919309227,
  'node6_CPU_ALL_User%': 6.391453566934289,
  'node6_CPU_ALL_Wait%': 0.23722957191216273,
  'node6_MEM_active': 80856.61808008248,
  'node6_MEM_cached': 136031.75704958837,
  'node6_MEM_inactive': 121362.71415768527,
  'node6_MEM_memfree': 553477.4305280168,
  'node6_MEM_memtotal': 772475.1000000001,
  'node6_NET_em1-read-KB/s': 11534.627002177818,
  'node6_NET_em1-write-KB/s': 307.0211866098917,
  'node6_NET_ib0-read-KB/s': 37295.10137077264,
  'node6_NET_ib0-write-KB/s': 28811.097686588997,
  'node6_NET_lo-read-KB/s': 604.3360343250384,
  'node6_NET_lo-write-KB/s': 604.3360343250384,
  'node7_CPU_ALL_Idle%': 94.14018028127215,
  'node7_CPU_ALL_Sys%': 0.4520385972559039,
  'node7_CPU_ALL_User%': 5.234345251619425,
  'node7_CPU_ALL_Wait%': 0.16248498815281254,
  'node7_MEM_active': 70933.50137343911,
  'node7_MEM_cached': 208717.27445922577,
  'node7_MEM_inactive': 187797.0670880031,
  'node7_MEM_memfree': 493418.82325526397,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 11504.352337674978,
  'node7_NET_em1-write-KB/s': 218.49221887852806,
  'node7_NET_ib0-read-KB/s': 34896.17573621807,
  'node7_NET_ib0-write-KB/s': 23617.331520010383,
  'node7_NET_lo-read-KB/s': 222.89507889624093,
  'node7_NET_lo-write-KB/s': 222.89507889624093,
  'node8_CPU_ALL_Idle%': 94.30648087598958,
  'node8_CPU_ALL_Sys%': 0.4737263413706584,
  'node8_CPU_ALL_User%': 5.041134593890148,
  'node8_CPU_ALL_Wait%': 0.17609950885589862,
  'node8_MEM_active': 72280.39302055942,
  'node8_MEM_cached': 179713.7132817608,
  'node8_MEM_inactive': 158309.04507812392,
  'node8_MEM_memfree': 523488.14740305813,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 48512.51259350985,
  'node8_NET_em1-write-KB/s': 516.0829759900565,
  'node8_NET_ib0-read-KB/s': 11981.502954285106,
  'node8_NET_ib0-write-KB/s': 64611.311071380536,
  'node8_NET_lo-read-KB/s': 402.07232015731455,
  'node8_NET_lo-write-KB/s': 402.07232015731455,
  'node5_CPU_ALL_Idle%': 95.3754885445526,
  'node5_CPU_ALL_Sys%': 0.3325578805217948,
  'node5_CPU_ALL_User%': 4.049700910031696,
  'node5_CPU_ALL_Wait%': 0.23819812796131548,
  'node5_MEM_active': 70159.61736856517,
  'node5_MEM_cached': 170033.7212272666,
  'node5_MEM_inactive': 131329.6969988909,
  'node5_MEM_memfree': 552653.7318798814,
  'node5_MEM_memtotal': 772475.0999999997,
  'node5_NET_em1-read-KB/s': 24573.216807510427,
  'node5_NET_em1-write-KB/s': 307.8484892360096,
  'node5_NET_ib0-read-KB/s': 9485.300354081688,
  'node5_NET_ib0-write-KB/s': 36542.24440592704,
  'node5_NET_lo-read-KB/s': 2553.030026405305,
  'node5_NET_lo-write-KB/s': 2553.030026405305,
  'streaming_num': np.inf},
 '7': {'t': 1525896368.763492,
  'node6_CPU_ALL_Idle%': 94.52109192119893,
  'node6_CPU_ALL_Sys%': 0.3533242701889584,
  'node6_CPU_ALL_User%': 5.067494147836511,
  'node6_CPU_ALL_Wait%': 0.05541978715017739,
  'node6_MEM_active': 50108.16825271694,
  'node6_MEM_cached': 29432.383650945598,
  'node6_MEM_inactive': 20217.40972866876,
  'node6_MEM_memfree': 689341.3755029644,
  'node6_MEM_memtotal': 772475.0999999996,
  'node6_NET_em1-read-KB/s': 10172.23436326048,
  'node6_NET_em1-write-KB/s': 291.7888989888427,
  'node6_NET_ib0-read-KB/s': 13905.192109433447,
  'node6_NET_ib0-write-KB/s': 21652.934911071246,
  'node6_NET_lo-read-KB/s': 547.3857327873997,
  'node6_NET_lo-write-KB/s': 547.3857327873997,
  'node7_CPU_ALL_Idle%': 92.14095825030533,
  'node7_CPU_ALL_Sys%': 0.5934981037475093,
  'node7_CPU_ALL_User%': 6.768308478498424,
  'node7_CPU_ALL_Wait%': 0.48437841486147715,
  'node7_MEM_active': 88974.29200601018,
  'node7_MEM_cached': 274276.1501365944,
  'node7_MEM_inactive': 256047.2153556277,
  'node7_MEM_memfree': 405995.6969402841,
  'node7_MEM_memtotal': 772475.1,
  'node7_NET_em1-read-KB/s': 37218.431920518095,
  'node7_NET_em1-write-KB/s': 418.83061644275887,
  'node7_NET_ib0-read-KB/s': 16541.184902294783,
  'node7_NET_ib0-write-KB/s': 51680.6555826959,
  'node7_NET_lo-read-KB/s': 2693.0595109918368,
  'node7_NET_lo-write-KB/s': 2693.0595109918368,
  'node8_CPU_ALL_Idle%': 92.49729029767315,
  'node8_CPU_ALL_Sys%': 0.5657478826680393,
  'node8_CPU_ALL_User%': 6.5805688042402934,
  'node8_CPU_ALL_Wait%': 0.34657889022045996,
  'node8_MEM_active': 88390.82223741464,
  'node8_MEM_cached': 244564.20265661823,
  'node8_MEM_inactive': 223987.75485277208,
  'node8_MEM_memfree': 439577.395931827,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 22937.21708745204,
  'node8_NET_em1-write-KB/s': 394.615066234487,
  'node8_NET_ib0-read-KB/s': 23405.169073682348,
  'node8_NET_ib0-write-KB/s': 37395.66812942869,
  'node8_NET_lo-read-KB/s': 7739.043972943191,
  'node8_NET_lo-write-KB/s': 7739.043972943191,
  'node5_CPU_ALL_Idle%': 94.13789837594469,
  'node5_CPU_ALL_Sys%': 0.49078871201157753,
  'node5_CPU_ALL_User%': 4.93955378678244,
  'node5_CPU_ALL_Wait%': 0.4196261456825856,
  'node5_MEM_active': 88618.59532641905,
  'node5_MEM_cached': 248841.77601463257,
  'node5_MEM_inactive': 215420.71940826497,
  'node5_MEM_memfree': 448383.4148552821,
  'node5_MEM_memtotal': 772475.0999999999,
  'node5_NET_em1-read-KB/s': 6755.909015918957,
  'node5_NET_em1-write-KB/s': 279.7346542852549,
  'node5_NET_ib0-read-KB/s': 23413.128158064,
  'node5_NET_ib0-write-KB/s': 25277.88550570831,
  'node5_NET_lo-read-KB/s': 420.5457766521949,
  'node5_NET_lo-write-KB/s': 420.5457766521949,
  'streaming_num': np.inf},
 '9': {'t': 1526099219.2870188,
  'node6_CPU_ALL_Idle%': 90.30802596517941,
  'node6_CPU_ALL_Sys%': 0.6821960210766733,
  'node6_CPU_ALL_User%': 8.560622483120632,
  'node6_CPU_ALL_Wait%': 0.4368050407709415,
  'node6_MEM_active': 106829.53485164186,
  'node6_MEM_cached': 282805.38360046485,
  'node6_MEM_inactive': 258735.85092861578,
  'node6_MEM_memfree': 383705.16991665494,
  'node6_MEM_memtotal': 772475.0999999997,
  'node6_NET_em1-read-KB/s': 20023.049107446957,
  'node6_NET_em1-write-KB/s': 333.38671788912706,
  'node6_NET_ib0-read-KB/s': 46908.655093863315,
  'node6_NET_ib0-write-KB/s': 39209.16977841444,
  'node6_NET_lo-read-KB/s': 839.1644942199425,
  'node6_NET_lo-write-KB/s': 839.1644942199425,
  'node7_CPU_ALL_Idle%': 91.94692780491711,
  'node7_CPU_ALL_Sys%': 0.5291232882197485,
  'node7_CPU_ALL_User%': 7.2168405141347005,
  'node7_CPU_ALL_Wait%': 0.286516977656763,
  'node7_MEM_active': 86172.94220689515,
  'node7_MEM_cached': 383054.37231120357,
  'node7_MEM_inactive': 361844.4572675582,
  'node7_MEM_memfree': 298813.8495074877,
  'node7_MEM_memtotal': 772475.0999999996,
  'node7_NET_em1-read-KB/s': 22246.3711379835,
  'node7_NET_em1-write-KB/s': 259.4832335629054,
  'node7_NET_ib0-read-KB/s': 31926.47694101866,
  'node7_NET_ib0-write-KB/s': 32520.913096620487,
  'node7_NET_lo-read-KB/s': 92.8562535036438,
  'node7_NET_lo-write-KB/s': 92.8562535036438,
  'node8_CPU_ALL_Idle%': 93.16666766715691,
  'node8_CPU_ALL_Sys%': 0.5967063861292032,
  'node8_CPU_ALL_User%': 5.91921141359266,
  'node8_CPU_ALL_Wait%': 0.31430500945463274,
  'node8_MEM_active': 77155.34845774432,
  'node8_MEM_cached': 315873.29871537053,
  'node8_MEM_inactive': 293530.2415923802,
  'node8_MEM_memfree': 378629.1995988033,
  'node8_MEM_memtotal': 772475.0999999997,
  'node8_NET_em1-read-KB/s': 27981.330999189606,
  'node8_NET_em1-write-KB/s': 373.725110304049,
  'node8_NET_ib0-read-KB/s': 18969.416092885513,
  'node8_NET_ib0-write-KB/s': 43766.28549689348,
  'node8_NET_lo-read-KB/s': 9395.46368420526,
  'node8_NET_lo-write-KB/s': 9395.46368420526,
  'node5_CPU_ALL_Idle%': 89.91802573819832,
  'node5_CPU_ALL_Sys%': 0.6232903696741228,
  'node5_CPU_ALL_User%': 8.838685292029558,
  'node5_CPU_ALL_Wait%': 0.610025298229124,
  'node5_MEM_active': 100511.43398462108,
  'node5_MEM_cached': 269741.3126131171,
  'node5_MEM_inactive': 227815.047085704,
  'node5_MEM_memfree': 422880.7330666854,
  'node5_MEM_memtotal': 772475.0999999996,
  'node5_NET_em1-read-KB/s': 45983.427892047555,
  'node5_NET_em1-write-KB/s': 511.1743337966342,
  'node5_NET_ib0-read-KB/s': 13704.985225034246,
  'node5_NET_ib0-write-KB/s': 61315.789938704285,
  'node5_NET_lo-read-KB/s': 5759.746580739347,
  'node5_NET_lo-write-KB/s': 5759.746580739347,
  'streaming_num': np.inf},
 '10': {'t': 1526007570.6762578,
  'node6_CPU_ALL_Idle%': 94.19072395261809,
  'node6_CPU_ALL_Sys%': 0.3859081061309474,
  'node6_CPU_ALL_User%': 5.272926479277453,
  'node6_CPU_ALL_Wait%': 0.14302411299625784,
  'node6_MEM_active': 67199.92758335442,
  'node6_MEM_cached': 111540.86639993246,
  'node6_MEM_inactive': 97019.16538983143,
  'node6_MEM_memfree': 591354.0175009145,
  'node6_MEM_memtotal': 772475.0999999999,
  'node6_NET_em1-read-KB/s': 6875.741492923666,
  'node6_NET_em1-write-KB/s': 279.7198294926986,
  'node6_NET_ib0-read-KB/s': 13260.239114825132,
  'node6_NET_ib0-write-KB/s': 22429.990811738557,
  'node6_NET_lo-read-KB/s': 464.31921442840655,
  'node6_NET_lo-write-KB/s': 464.31921442840655,
  'node7_CPU_ALL_Idle%': 91.19985192025088,
  'node7_CPU_ALL_Sys%': 0.5966774958194215,
  'node7_CPU_ALL_User%': 7.705615769648719,
  'node7_CPU_ALL_Wait%': 0.4816882217480167,
  'node7_MEM_active': 95614.21638505241,
  'node7_MEM_cached': 321477.1031248768,
  'node7_MEM_inactive': 300214.0682152168,
  'node7_MEM_memfree': 353009.68748134933,
  'node7_MEM_memtotal': 772475.1000000001,
  'node7_NET_em1-read-KB/s': 41217.34553593045,
  'node7_NET_em1-write-KB/s': 401.09305883214057,
  'node7_NET_ib0-read-KB/s': 22164.79283812012,
  'node7_NET_ib0-write-KB/s': 57784.870533819034,
  'node7_NET_lo-read-KB/s': 1918.2357621039705,
  'node7_NET_lo-write-KB/s': 1918.2357621039705,
  'node8_CPU_ALL_Idle%': 92.54930845496798,
  'node8_CPU_ALL_Sys%': 0.4927238658999088,
  'node8_CPU_ALL_User%': 6.671020380602977,
  'node8_CPU_ALL_Wait%': 0.2773877716382133,
  'node8_MEM_active': 90041.4074578827,
  'node8_MEM_cached': 238244.24538763662,
  'node8_MEM_inactive': 215166.8559870131,
  'node8_MEM_memfree': 446271.4102161852,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 27391.10264801539,
  'node8_NET_em1-write-KB/s': 320.99054175716583,
  'node8_NET_ib0-read-KB/s': 23051.14132108171,
  'node8_NET_ib0-write-KB/s': 41446.08598622538,
  'node8_NET_lo-read-KB/s': 5254.00500680854,
  'node8_NET_lo-write-KB/s': 5254.00500680854,
  'node5_CPU_ALL_Idle%': 91.26711382228095,
  'node5_CPU_ALL_Sys%': 0.5395670873977455,
  'node5_CPU_ALL_User%': 7.758873302785821,
  'node5_CPU_ALL_Wait%': 0.4185764484299889,
  'node5_MEM_active': 100533.26588030247,
  'node5_MEM_cached': 269334.26891856187,
  'node5_MEM_inactive': 228893.89469541507,
  'node5_MEM_memfree': 422478.34430719935,
  'node5_MEM_memtotal': 772475.0999999999,
  'node5_NET_em1-read-KB/s': 14439.120357012342,
  'node5_NET_em1-write-KB/s': 310.9853012115931,
  'node5_NET_ib0-read-KB/s': 33060.52224383662,
  'node5_NET_ib0-write-KB/s': 30527.226526298036,
  'node5_NET_lo-read-KB/s': 437.3084283023642,
  'node5_NET_lo-write-KB/s': 437.3084283023642,
  'streaming_num': np.inf}}


abnormal_streaming_dict = {'1': {'node6_CPU_ALL_Idle%': 73.33192392424762,
  'node6_CPU_ALL_Sys%': 2.7995027992804737,
  'node6_CPU_ALL_User%': 23.632291771934437,
  'node6_CPU_ALL_Wait%': 0.2333164904905309,
  'node6_MEM_active': 146931.00940841198,
  'node6_MEM_cached': 262948.8091052408,
  'node6_MEM_inactive': 187386.45915677992,
  'node6_MEM_memfree': 391432.10310245166,
  'node6_MEM_memtotal': 772475.0999999997,
  'node6_NET_em1-read-KB/s': 230.11149422964203,
  'node6_NET_em1-write-KB/s': 152.41695737413343,
  'node6_NET_ib0-read-KB/s': 263688.76281908766,
  'node6_NET_ib0-write-KB/s': 125744.09151727064,
  'node6_NET_lo-read-KB/s': 3361.9189926632575,
  'node6_NET_lo-write-KB/s': 3361.9189926632575,
  'node7_CPU_ALL_Idle%': 65.58468845368743,
  'node7_CPU_ALL_Sys%': 4.3086541765193305,
  'node7_CPU_ALL_User%': 29.697944582550175,
  'node7_CPU_ALL_Wait%': 0.4003557064613269,
  'node7_MEM_active': 123523.40223933387,
  'node7_MEM_cached': 220769.74499888843,
  'node7_MEM_inactive': 177627.271167566,
  'node7_MEM_memfree': 434478.82167990465,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 207.26772974393177,
  'node7_NET_em1-write-KB/s': 259.0508720871481,
  'node7_NET_ib0-read-KB/s': 336596.0809009883,
  'node7_NET_ib0-write-KB/s': 217379.26761454353,
  'node7_NET_lo-read-KB/s': 342.0790335293761,
  'node7_NET_lo-write-KB/s': 342.0790335293761,
  'node8_CPU_ALL_Idle%': 79.86597563193308,
  'node8_CPU_ALL_Sys%': 1.7527065527065526,
  'node8_CPU_ALL_User%': 17.964225818835747,
  'node8_CPU_ALL_Wait%': 0.415059303711786,
  'node8_MEM_active': 79348.46917015215,
  'node8_MEM_cached': 206244.9138206947,
  'node8_MEM_inactive': 166546.84154694795,
  'node8_MEM_memfree': 493281.9246186176,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 75.93979107312441,
  'node8_NET_em1-write-KB/s': 92.00014952213535,
  'node8_NET_ib0-read-KB/s': 164296.716625245,
  'node8_NET_ib0-write-KB/s': 114377.52034713382,
  'node8_NET_lo-read-KB/s': 264.7952658059041,
  'node8_NET_lo-write-KB/s': 264.7952658059041,
  'node5_CPU_ALL_Idle%': 79.0513321241435,
  'node5_CPU_ALL_Sys%': 1.7785630794034661,
  'node5_CPU_ALL_User%': 19.01307335751713,
  'node5_CPU_ALL_Wait%': 0.14945787988714232,
  'node5_MEM_active': 93853.73567311569,
  'node5_MEM_cached': 146447.53566908505,
  'node5_MEM_inactive': 107987.7157496977,
  'node5_MEM_memfree': 545270.0563603386,
  'node5_MEM_memtotal': 772475.0999999997,
  'node5_NET_em1-read-KB/s': 138.3917674324869,
  'node5_NET_em1-write-KB/s': 138.32429463925837,
  'node5_NET_ib0-read-KB/s': 215218.97621523577,
  'node5_NET_ib0-write-KB/s': 109288.40695888753,
  'node5_NET_lo-read-KB/s': 102.09071342200728,
  'node5_NET_lo-write-KB/s': 102.09071342200728,
  'streaming_num': np.inf,
  't': 1528974404.2982614,
  'anomaly_label': 0.16071392598859813},
 0: {'node6_CPU_ALL_Idle%': 0.0,
  'node6_CPU_ALL_Sys%': 0.0,
  'node6_CPU_ALL_User%': 0.0,
  'node6_CPU_ALL_Wait%': 0.0,
  'node6_MEM_active': 0.0,
  'node6_MEM_cached': 0.0,
  'node6_MEM_inactive': 0.0,
  'node6_MEM_memfree': 0.0,
  'node6_MEM_memtotal': 0.0,
  'node6_NET_em1-read-KB/s': 0.0,
  'node6_NET_em1-write-KB/s': 0.0,
  'node6_NET_ib0-read-KB/s': 0.0,
  'node6_NET_ib0-write-KB/s': 0.0,
  'node6_NET_lo-read-KB/s': 0.0,
  'node6_NET_lo-write-KB/s': 0.0,
  'node7_CPU_ALL_Idle%': 0.0,
  'node7_CPU_ALL_Sys%': 0.0,
  'node7_CPU_ALL_User%': 0.0,
  'node7_CPU_ALL_Wait%': 0.0,
  'node7_MEM_active': 0.0,
  'node7_MEM_cached': 0.0,
  'node7_MEM_inactive': 0.0,
  'node7_MEM_memfree': 0.0,
  'node7_MEM_memtotal': 0.0,
  'node7_NET_em1-read-KB/s': 0.0,
  'node7_NET_em1-write-KB/s': 0.0,
  'node7_NET_ib0-read-KB/s': 0.0,
  'node7_NET_ib0-write-KB/s': 0.0,
  'node7_NET_lo-read-KB/s': 0.0,
  'node7_NET_lo-write-KB/s': 0.0,
  'node8_CPU_ALL_Idle%': 0.0,
  'node8_CPU_ALL_Sys%': 0.0,
  'node8_CPU_ALL_User%': 0.0,
  'node8_CPU_ALL_Wait%': 0.0,
  'node8_MEM_active': 0.0,
  'node8_MEM_cached': 0.0,
  'node8_MEM_inactive': 0.0,
  'node8_MEM_memfree': 0.0,
  'node8_MEM_memtotal': 0.0,
  'node8_NET_em1-read-KB/s': 0.0,
  'node8_NET_em1-write-KB/s': 0.0,
  'node8_NET_ib0-read-KB/s': 0.0,
  'node8_NET_ib0-write-KB/s': 0.0,
  'node8_NET_lo-read-KB/s': 0.0,
  'node8_NET_lo-write-KB/s': 0.0,
  'node5_CPU_ALL_Idle%': 0.0,
  'node5_CPU_ALL_Sys%': 0.0,
  'node5_CPU_ALL_User%': 0.0,
  'node5_CPU_ALL_Wait%': 0.0,
  'node5_MEM_active': 0.0,
  'node5_MEM_cached': 0.0,
  'node5_MEM_inactive': 0.0,
  'node5_MEM_memfree': 0.0,
  'node5_MEM_memtotal': 0.0,
  'node5_NET_em1-read-KB/s': 0.0,
  'node5_NET_em1-write-KB/s': 0.0,
  'node5_NET_ib0-read-KB/s': 0.0,
  'node5_NET_ib0-write-KB/s': 0.0,
  'node5_NET_lo-read-KB/s': 0.0,
  'node5_NET_lo-write-KB/s': 0.0,
  'streaming_num': 0.0,
  't': 1528475219.91831,
  'anomaly_label': 0.1090543259557344},
 '2': {'node6_CPU_ALL_Idle%': 92.41510066066691,
  'node6_CPU_ALL_Sys%': 0.8113416220152941,
  'node6_CPU_ALL_User%': 6.674469125526714,
  'node6_CPU_ALL_Wait%': 0.09906778338448732,
  'node6_MEM_active': 66331.53393122822,
  'node6_MEM_cached': 96340.20115070487,
  'node6_MEM_inactive': 57068.64133694012,
  'node6_MEM_memfree': 616575.1611371794,
  'node6_MEM_memtotal': 772475.0999999996,
  'node6_NET_em1-read-KB/s': 7270.249552099049,
  'node6_NET_em1-write-KB/s': 243.2813234146595,
  'node6_NET_ib0-read-KB/s': 51818.693494251675,
  'node6_NET_ib0-write-KB/s': 32883.254879051136,
  'node6_NET_lo-read-KB/s': 2060.77939967747,
  'node6_NET_lo-write-KB/s': 2060.77939967747,
  'node7_CPU_ALL_Idle%': 83.18020817069997,
  'node7_CPU_ALL_Sys%': 1.8971189175123602,
  'node7_CPU_ALL_User%': 14.647335935467083,
  'node7_CPU_ALL_Wait%': 0.2735966692688004,
  'node7_MEM_active': 65756.5608659901,
  'node7_MEM_cached': 93555.21724069737,
  'node7_MEM_inactive': 66392.45056778559,
  'node7_MEM_memfree': 617490.6659203747,
  'node7_MEM_memtotal': 772475.0999999996,
  'node7_NET_em1-read-KB/s': 5569.5597210512615,
  'node7_NET_em1-write-KB/s': 307.44538017174085,
  'node7_NET_ib0-read-KB/s': 133432.76058704138,
  'node7_NET_ib0-write-KB/s': 99134.9902607338,
  'node7_NET_lo-read-KB/s': 242.58057038771793,
  'node7_NET_lo-write-KB/s': 242.58057038771793,
  'node8_CPU_ALL_Idle%': 84.68288316452004,
  'node8_CPU_ALL_Sys%': 1.5060960360135052,
  'node8_CPU_ALL_User%': 13.477429035888457,
  'node8_CPU_ALL_Wait%': 0.3305437455712559,
  'node8_MEM_active': 55013.01992413822,
  'node8_MEM_cached': 91364.52188216415,
  'node8_MEM_inactive': 67235.71092284606,
  'node8_MEM_memfree': 628735.3864605477,
  'node8_MEM_memtotal': 772475.0999999997,
  'node8_NET_em1-read-KB/s': 137.96839960818642,
  'node8_NET_em1-write-KB/s': 146.7449616522863,
  'node8_NET_ib0-read-KB/s': 132075.56735338253,
  'node8_NET_ib0-write-KB/s': 70856.72685694636,
  'node8_NET_lo-read-KB/s': 7899.471912383811,
  'node8_NET_lo-write-KB/s': 7899.471912383811,
  'node5_CPU_ALL_Idle%': 86.11418566113248,
  'node5_CPU_ALL_Sys%': 1.3200273061730714,
  'node5_CPU_ALL_User%': 12.260978228016969,
  'node5_CPU_ALL_Wait%': 0.30463996498139634,
  'node5_MEM_active': 65978.69397700863,
  'node5_MEM_cached': 88811.22125399952,
  'node5_MEM_inactive': 61700.940660142354,
  'node5_MEM_memfree': 625263.0687834163,
  'node5_MEM_memtotal': 772475.0999999997,
  'node5_NET_em1-read-KB/s': 4053.9084305203805,
  'node5_NET_em1-write-KB/s': 214.66137427174857,
  'node5_NET_ib0-read-KB/s': 120770.51425340546,
  'node5_NET_ib0-write-KB/s': 68302.06691784176,
  'node5_NET_lo-read-KB/s': 1406.7733754390354,
  'node5_NET_lo-write-KB/s': 1406.7733754390354,
  'streaming_num': np.inf,
  't': 1528205176.6012633,
  'anomaly_label': 0.051034296460222964},
 '3': {'node6_CPU_ALL_Idle%': 74.56827708937516,
  'node6_CPU_ALL_Sys%': 2.6550355918797783,
  'node6_CPU_ALL_User%': 22.018586870551015,
  'node6_CPU_ALL_Wait%': 0.7562878987608753,
  'node6_MEM_active': 120342.90375032955,
  'node6_MEM_cached': 194789.54344845767,
  'node6_MEM_inactive': 134012.07808462958,
  'node6_MEM_memfree': 481814.0956301081,
  'node6_MEM_memtotal': 772475.0999999997,
  'node6_NET_em1-read-KB/s': 198.30255734247297,
  'node6_NET_em1-write-KB/s': 297.36701160031635,
  'node6_NET_ib0-read-KB/s': 213511.2963946744,
  'node6_NET_ib0-write-KB/s': 122039.73530187187,
  'node6_NET_lo-read-KB/s': 668.5367123648826,
  'node6_NET_lo-write-KB/s': 668.5367123648826,
  'node7_CPU_ALL_Idle%': 61.90369368775147,
  'node7_CPU_ALL_Sys%': 3.7610184024800475,
  'node7_CPU_ALL_User%': 33.39256645340017,
  'node7_CPU_ALL_Wait%': 0.9414154739133302,
  'node7_MEM_active': 107542.45589341072,
  'node7_MEM_cached': 169786.54784644808,
  'node7_MEM_inactive': 134202.91772310532,
  'node7_MEM_memfree': 501935.1346085351,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 153.4938262647583,
  'node7_NET_em1-write-KB/s': 122.27429589077238,
  'node7_NET_ib0-read-KB/s': 307221.64193654776,
  'node7_NET_ib0-write-KB/s': 170089.7732273597,
  'node7_NET_lo-read-KB/s': 8909.493799881275,
  'node7_NET_lo-write-KB/s': 8909.493799881275,
  'node8_CPU_ALL_Idle%': 71.30452869931543,
  'node8_CPU_ALL_Sys%': 2.7298775671406004,
  'node8_CPU_ALL_User%': 25.152145866245395,
  'node8_CPU_ALL_Wait%': 0.8054502369668246,
  'node8_MEM_active': 93388.28815165877,
  'node8_MEM_cached': 143908.1018430753,
  'node8_MEM_inactive': 111940.33826355978,
  'node8_MEM_memfree': 540569.9042785676,
  'node8_MEM_memtotal': 772475.0999999996,
  'node8_NET_em1-read-KB/s': 153.1837019483939,
  'node8_NET_em1-write-KB/s': 114.73575566087415,
  'node8_NET_ib0-read-KB/s': 258842.7163967878,
  'node8_NET_ib0-write-KB/s': 123442.30724065297,
  'node8_NET_lo-read-KB/s': 8263.080983412323,
  'node8_NET_lo-write-KB/s': 8263.080983412323,
  'node5_CPU_ALL_Idle%': 76.9095862432468,
  'node5_CPU_ALL_Sys%': 2.281947555672684,
  'node5_CPU_ALL_User%': 20.21053498484649,
  'node5_CPU_ALL_Wait%': 0.5901040980366319,
  'node5_MEM_active': 83392.013236263,
  'node5_MEM_cached': 125990.29957833709,
  'node5_MEM_inactive': 94637.12671629991,
  'node5_MEM_memfree': 573745.6467848202,
  'node5_MEM_memtotal': 772475.0999999999,
  'node5_NET_em1-read-KB/s': 126.32983924100672,
  'node5_NET_em1-write-KB/s': 98.1303004348399,
  'node5_NET_ib0-read-KB/s': 215982.07491764397,
  'node5_NET_ib0-write-KB/s': 107165.45333377256,
  'node5_NET_lo-read-KB/s': 158.57948346290686,
  'node5_NET_lo-write-KB/s': 158.57948346290686,
  'streaming_num': np.inf,
  't': 1528773663.5693066,
  'anomaly_label': 0.13979625369700954},
 '4': {'node6_CPU_ALL_Idle%': 71.69648101967303,
  'node6_CPU_ALL_Sys%': 3.4630368523136603,
  'node6_CPU_ALL_User%': 24.712995289553895,
  'node6_CPU_ALL_Wait%': 0.12831809365475202,
  'node6_MEM_active': 160802.91773344416,
  'node6_MEM_cached': 193893.30055417016,
  'node6_MEM_inactive': 120887.16730396231,
  'node6_MEM_memfree': 446744.08088113053,
  'node6_MEM_memtotal': 772475.0999999999,
  'node6_NET_em1-read-KB/s': 485.976004433361,
  'node6_NET_em1-write-KB/s': 432.9766694375173,
  'node6_NET_ib0-read-KB/s': 251367.11559988913,
  'node6_NET_ib0-write-KB/s': 113755.53374896094,
  'node6_NET_lo-read-KB/s': 46584.44660570795,
  'node6_NET_lo-write-KB/s': 46584.44660570795,
  'node7_CPU_ALL_Idle%': 66.69138026607538,
  'node7_CPU_ALL_Sys%': 4.3015521064301545,
  'node7_CPU_ALL_User%': 28.875304878048784,
  'node7_CPU_ALL_Wait%': 0.13264966740576498,
  'node7_MEM_active': 112100.08240022173,
  'node7_MEM_cached': 101839.26086474503,
  'node7_MEM_inactive': 59375.96438470067,
  'node7_MEM_memfree': 567232.175,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 382.55839800443465,
  'node7_NET_em1-write-KB/s': 377.27458425720624,
  'node7_NET_ib0-read-KB/s': 320780.3960365854,
  'node7_NET_ib0-write-KB/s': 211412.88228935696,
  'node7_NET_lo-read-KB/s': 1348.9628880266075,
  'node7_NET_lo-write-KB/s': 1348.9628880266075,
  'node8_CPU_ALL_Idle%': 79.30980609418283,
  'node8_CPU_ALL_Sys%': 1.9140443213296399,
  'node8_CPU_ALL_User%': 18.69060941828255,
  'node8_CPU_ALL_Wait%': 0.08512465373961219,
  'node8_MEM_active': 91551.78761772854,
  'node8_MEM_cached': 85355.44789473683,
  'node8_MEM_inactive': 45541.60670360111,
  'node8_MEM_memfree': 604066.6030470914,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 210.23412742382274,
  'node8_NET_em1-write-KB/s': 185.74199445983382,
  'node8_NET_ib0-read-KB/s': 175925.0440166205,
  'node8_NET_ib0-write-KB/s': 92618.47365650968,
  'node8_NET_lo-read-KB/s': 418.4104709141274,
  'node8_NET_lo-write-KB/s': 418.4104709141274,
  'node5_CPU_ALL_Idle%': 76.99163214581607,
  'node5_CPU_ALL_Sys%': 2.0578017122341894,
  'node5_CPU_ALL_User%': 20.834493233913285,
  'node5_CPU_ALL_Wait%': 0.11894504280585474,
  'node5_MEM_active': 91734.31607290804,
  'node5_MEM_cached': 66998.51565865782,
  'node5_MEM_inactive': 28881.740403203534,
  'node5_MEM_memfree': 628344.2310411488,
  'node5_MEM_memtotal': 772475.0999999999,
  'node5_NET_em1-read-KB/s': 272.25125655896164,
  'node5_NET_em1-write-KB/s': 219.5100524716929,
  'node5_NET_ib0-read-KB/s': 228762.9988677161,
  'node5_NET_ib0-write-KB/s': 104847.00477768571,
  'node5_NET_lo-read-KB/s': 133.98909141121237,
  'node5_NET_lo-write-KB/s': 133.98909141121237,
  'streaming_num': np.inf,
  't': 1528967971.7191384,
  'anomaly_label': 0.14747307373653687},
 '5': {'node6_CPU_ALL_Idle%': 90.73745576506627,
  'node6_CPU_ALL_Sys%': 1.04379073575239,
  'node6_CPU_ALL_User%': 8.12466434268209,
  'node6_CPU_ALL_Wait%': 0.09052659377805947,
  'node6_MEM_active': 73412.58824275075,
  'node6_MEM_cached': 95921.59326097288,
  'node6_MEM_inactive': 62298.696132678386,
  'node6_MEM_memfree': 608576.3699852108,
  'node6_MEM_memtotal': 772475.0999999999,
  'node6_NET_em1-read-KB/s': 4042.14173453758,
  'node6_NET_em1-write-KB/s': 179.69257751016744,
  'node6_NET_ib0-read-KB/s': 81882.24421380658,
  'node6_NET_ib0-write-KB/s': 49101.25380605292,
  'node6_NET_lo-read-KB/s': 2537.7266846247294,
  'node6_NET_lo-write-KB/s': 2537.7266846247294,
  'node7_CPU_ALL_Idle%': 87.69412193421635,
  'node7_CPU_ALL_Sys%': 1.3007789889515602,
  'node7_CPU_ALL_User%': 10.823785305363668,
  'node7_CPU_ALL_Wait%': 0.17898631091957667,
  'node7_MEM_active': 59212.86468935505,
  'node7_MEM_cached': 65420.45026459218,
  'node7_MEM_inactive': 44451.145110061894,
  'node7_MEM_memfree': 649936.6899280688,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 4461.894660624881,
  'node7_NET_em1-write-KB/s': 293.4826985233538,
  'node7_NET_ib0-read-KB/s': 101880.4180561717,
  'node7_NET_ib0-write-KB/s': 77403.01608678202,
  'node7_NET_lo-read-KB/s': 200.75660160128436,
  'node7_NET_lo-write-KB/s': 200.75660160128436,
  'node8_CPU_ALL_Idle%': 88.96222250385483,
  'node8_CPU_ALL_Sys%': 1.1090604735652578,
  'node8_CPU_ALL_User%': 9.739873370931289,
  'node8_CPU_ALL_Wait%': 0.18581099634581671,
  'node8_MEM_active': 50951.53833618486,
  'node8_MEM_cached': 65744.02449886994,
  'node8_MEM_inactive': 46495.75313087469,
  'node8_MEM_memfree': 657766.2896468327,
  'node8_MEM_memtotal': 772475.0999999997,
  'node8_NET_em1-read-KB/s': 5345.976188665694,
  'node8_NET_em1-write-KB/s': 152.75360084912236,
  'node8_NET_ib0-read-KB/s': 93052.23047176986,
  'node8_NET_ib0-write-KB/s': 59479.66470333524,
  'node8_NET_lo-read-KB/s': 4139.446138288658,
  'node8_NET_lo-write-KB/s': 4139.446138288658,
  'node5_CPU_ALL_Idle%': 88.75178047891475,
  'node5_CPU_ALL_Sys%': 1.1371187989625098,
  'node5_CPU_ALL_User%': 9.926308616345224,
  'node5_CPU_ALL_Wait%': 0.18577307279863503,
  'node5_MEM_active': 64002.07452074188,
  'node5_MEM_cached': 71487.32167583186,
  'node5_MEM_inactive': 50123.85426749708,
  'node5_MEM_memfree': 641354.3703332752,
  'node5_MEM_memtotal': 772475.0999999997,
  'node5_NET_em1-read-KB/s': 4632.081540704585,
  'node5_NET_em1-write-KB/s': 229.2853879758905,
  'node5_NET_ib0-read-KB/s': 112686.17444572988,
  'node5_NET_ib0-write-KB/s': 65218.33099475444,
  'node5_NET_lo-read-KB/s': 795.8279007728352,
  'node5_NET_lo-write-KB/s': 795.8279007728352,
  'streaming_num': np.inf,
  't': 1528107564.1843834,
  'anomaly_label': 0.08416371138149263},
 '6': {'node6_CPU_ALL_Idle%': 83.152395789125,
  'node6_CPU_ALL_Sys%': 1.3702060927261999,
  'node6_CPU_ALL_User%': 15.308389661204675,
  'node6_CPU_ALL_Wait%': 0.1645895224983697,
  'node6_MEM_active': 94596.8476859855,
  'node6_MEM_cached': 90539.7777780078,
  'node6_MEM_inactive': 68735.99283799311,
  'node6_MEM_memfree': 588894.5169759955,
  'node6_MEM_memtotal': 772475.0999999999,
  'node6_NET_em1-read-KB/s': 8552.214397507427,
  'node6_NET_em1-write-KB/s': 340.9008570807498,
  'node6_NET_ib0-read-KB/s': 114202.03368389455,
  'node6_NET_ib0-write-KB/s': 69810.57785357168,
  'node6_NET_lo-read-KB/s': 2885.353579968325,
  'node6_NET_lo-write-KB/s': 2885.353579968325,
  'node7_CPU_ALL_Idle%': 89.09123486181554,
  'node7_CPU_ALL_Sys%': 0.8994410516509678,
  'node7_CPU_ALL_User%': 9.832986233309184,
  'node7_CPU_ALL_Wait%': 0.1744053410620019,
  'node7_MEM_active': 57930.146338888306,
  'node7_MEM_cached': 54980.35487527171,
  'node7_MEM_inactive': 42785.63161577477,
  'node7_MEM_memfree': 656852.6503726322,
  'node7_MEM_memtotal': 772475.0999999996,
  'node7_NET_em1-read-KB/s': 8854.487387434014,
  'node7_NET_em1-write-KB/s': 381.8364838008488,
  'node7_NET_ib0-read-KB/s': 88954.90095331747,
  'node7_NET_ib0-write-KB/s': 60081.46305247903,
  'node7_NET_lo-read-KB/s': 2202.1682082600146,
  'node7_NET_lo-write-KB/s': 2202.1682082600146,
  'node8_CPU_ALL_Idle%': 91.20943460666716,
  'node8_CPU_ALL_Sys%': 0.6753371350506608,
  'node8_CPU_ALL_User%': 7.990917276424868,
  'node8_CPU_ALL_Wait%': 0.12115024373078871,
  'node8_MEM_active': 40506.99057781273,
  'node8_MEM_cached': 63140.65435558821,
  'node8_MEM_inactive': 51955.35382258883,
  'node8_MEM_memfree': 667444.0373192718,
  'node8_MEM_memtotal': 772475.0999999997,
  'node8_NET_em1-read-KB/s': 18468.429999068543,
  'node8_NET_em1-write-KB/s': 272.33403537460026,
  'node8_NET_ib0-read-KB/s': 44482.78958529543,
  'node8_NET_ib0-write-KB/s': 47775.27353942643,
  'node8_NET_lo-read-KB/s': 4481.969194705194,
  'node8_NET_lo-write-KB/s': 4481.969194705194,
  'node5_CPU_ALL_Idle%': 89.67825131311463,
  'node5_CPU_ALL_Sys%': 0.8622803306262704,
  'node5_CPU_ALL_User%': 9.376852033392842,
  'node5_CPU_ALL_Wait%': 0.08299916414706884,
  'node5_MEM_active': 53413.57291423737,
  'node5_MEM_cached': 32328.914268319117,
  'node5_MEM_inactive': 23064.202501367294,
  'node5_MEM_memfree': 683881.5927043455,
  'node5_MEM_memtotal': 772475.0999999999,
  'node5_NET_em1-read-KB/s': 8548.205944874984,
  'node5_NET_em1-write-KB/s': 202.59323887851238,
  'node5_NET_ib0-read-KB/s': 97929.58912772042,
  'node5_NET_ib0-write-KB/s': 58005.809410052934,
  'node5_NET_lo-read-KB/s': 776.7381458511769,
  'node5_NET_lo-write-KB/s': 776.7381458511769,
  'streaming_num': np.inf,
  't': 1528309673.0418081,
  'anomaly_label': 0.08977599851422322},
 '8': {'node6_CPU_ALL_Idle%': 79.1651864207633,
  'node6_CPU_ALL_Sys%': 1.687825475755859,
  'node6_CPU_ALL_User%': 18.90253876334949,
  'node6_CPU_ALL_Wait%': 0.2391452130672877,
  'node6_MEM_active': 115344.89411993037,
  'node6_MEM_cached': 186965.52778372253,
  'node6_MEM_inactive': 139655.277347307,
  'node6_MEM_memfree': 481276.04050271714,
  'node6_MEM_memtotal': 772475.0999999999,
  'node6_NET_em1-read-KB/s': 8624.505331403036,
  'node6_NET_em1-write-KB/s': 321.24428148800905,
  'node6_NET_ib0-read-KB/s': 145166.34908415686,
  'node6_NET_ib0-write-KB/s': 70784.68932775226,
  'node6_NET_lo-read-KB/s': 1181.8884958351691,
  'node6_NET_lo-write-KB/s': 1181.8884958351691,
  'node7_CPU_ALL_Idle%': 77.09037164105729,
  'node7_CPU_ALL_Sys%': 2.60027195799295,
  'node7_CPU_ALL_User%': 19.937990439630557,
  'node7_CPU_ALL_Wait%': 0.36284217022478377,
  'node7_MEM_active': 87962.95691348598,
  'node7_MEM_cached': 156192.45103814735,
  'node7_MEM_inactive': 128808.5600127611,
  'node7_MEM_memfree': 528108.1844628305,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 8914.023245086451,
  'node7_NET_em1-write-KB/s': 283.6907011286256,
  'node7_NET_ib0-read-KB/s': 198550.5004790645,
  'node7_NET_ib0-write-KB/s': 124329.96778762172,
  'node7_NET_lo-read-KB/s': 3551.656549480665,
  'node7_NET_lo-write-KB/s': 3551.656549480665,
  'node8_CPU_ALL_Idle%': 85.25180026639538,
  'node8_CPU_ALL_Sys%': 1.1571271251324111,
  'node8_CPU_ALL_User%': 13.253583227579263,
  'node8_CPU_ALL_Wait%': 0.3308672532958562,
  'node8_MEM_active': 61067.846423065224,
  'node8_MEM_cached': 150893.33341164378,
  'node8_MEM_inactive': 125459.25917123767,
  'node8_MEM_memfree': 561630.6820434834,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 18690.97868941865,
  'node8_NET_em1-write-KB/s': 268.11402246531094,
  'node8_NET_ib0-read-KB/s': 92010.15164923908,
  'node8_NET_ib0-write-KB/s': 74925.54781797016,
  'node8_NET_lo-read-KB/s': 5680.699437842826,
  'node8_NET_lo-write-KB/s': 5680.699437842826,
  'node5_CPU_ALL_Idle%': 85.55486103828004,
  'node5_CPU_ALL_Sys%': 1.135392763502884,
  'node5_CPU_ALL_User%': 13.139955951756685,
  'node5_CPU_ALL_Wait%': 0.16612899842684847,
  'node5_MEM_active': 57706.00930886209,
  'node5_MEM_cached': 89927.93169375983,
  'node5_MEM_inactive': 67192.73159622442,
  'node5_MEM_memfree': 627920.4889155742,
  'node5_MEM_memtotal': 772475.0999999999,
  'node5_NET_em1-read-KB/s': 8647.70972207656,
  'node5_NET_em1-write-KB/s': 192.5957912952281,
  'node5_NET_ib0-read-KB/s': 123906.66215102255,
  'node5_NET_ib0-write-KB/s': 68771.63957524908,
  'node5_NET_lo-read-KB/s': 729.9765621394863,
  'node5_NET_lo-write-KB/s': 729.9765621394863,
  'streaming_num': np.inf,
  't': 1528635199.9772341,
  'anomaly_label': 0.09267354066885575},
 '9': {'node6_CPU_ALL_Idle%': 78.39922886926759,
  'node6_CPU_ALL_Sys%': 2.3932844529153217,
  'node6_CPU_ALL_User%': 18.965021004317553,
  'node6_CPU_ALL_Wait%': 0.23946088918277647,
  'node6_MEM_active': 124336.07343440042,
  'node6_MEM_cached': 180721.86920144694,
  'node6_MEM_inactive': 128771.60728052432,
  'node6_MEM_memfree': 487938.60880333727,
  'node6_MEM_memtotal': 772475.0999999999,
  'node6_NET_em1-read-KB/s': 233.63525710840563,
  'node6_NET_em1-write-KB/s': 137.4758790695865,
  'node6_NET_ib0-read-KB/s': 232822.42092846867,
  'node6_NET_ib0-write-KB/s': 123431.67210801666,
  'node6_NET_lo-read-KB/s': 195.702855031312,
  'node6_NET_lo-write-KB/s': 195.702855031312,
  'node7_CPU_ALL_Idle%': 76.31346135167162,
  'node7_CPU_ALL_Sys%': 2.8238397731025504,
  'node7_CPU_ALL_User%': 20.417405831730676,
  'node7_CPU_ALL_Wait%': 0.4420673310410475,
  'node7_MEM_active': 97222.040008159,
  'node7_MEM_cached': 149673.87670610173,
  'node7_MEM_inactive': 120814.08507974434,
  'node7_MEM_memfree': 529234.7999407502,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 243.60634069584475,
  'node7_NET_em1-write-KB/s': 329.659438195699,
  'node7_NET_ib0-read-KB/s': 243813.74103968765,
  'node7_NET_ib0-write-KB/s': 160136.8350884861,
  'node7_NET_lo-read-KB/s': 1552.108352273831,
  'node7_NET_lo-write-KB/s': 1552.108352273831,
  'node8_CPU_ALL_Idle%': 85.96236508955137,
  'node8_CPU_ALL_Sys%': 1.3653841666180502,
  'node8_CPU_ALL_User%': 12.340062812360227,
  'node8_CPU_ALL_Wait%': 0.32964626723450596,
  'node8_MEM_active': 60516.50900375319,
  'node8_MEM_cached': 133330.43674523075,
  'node8_MEM_inactive': 107042.66323629505,
  'node8_MEM_memfree': 582736.3080625401,
  'node8_MEM_memtotal': 772475.0999999997,
  'node8_NET_em1-read-KB/s': 92.37578029286504,
  'node8_NET_em1-write-KB/s': 82.64796005678393,
  'node8_NET_ib0-read-KB/s': 125665.89595511733,
  'node8_NET_ib0-write-KB/s': 90395.70189020477,
  'node8_NET_lo-read-KB/s': 1500.1240534391222,
  'node8_NET_lo-write-KB/s': 1500.1240534391222,
  'node5_CPU_ALL_Idle%': 80.97684589832748,
  'node5_CPU_ALL_Sys%': 1.8092697993356517,
  'node5_CPU_ALL_User%': 16.903450921735075,
  'node5_CPU_ALL_Wait%': 0.30729909283397117,
  'node5_MEM_active': 94445.52476252452,
  'node5_MEM_cached': 118696.31964198995,
  'node5_MEM_inactive': 92719.85890071679,
  'node5_MEM_memfree': 566655.9309291168,
  'node5_MEM_memtotal': 772475.0999999999,
  'node5_NET_em1-read-KB/s': 130.49631403096404,
  'node5_NET_em1-write-KB/s': 150.94142271605898,
  'node5_NET_ib0-read-KB/s': 211879.8335282348,
  'node5_NET_ib0-write-KB/s': 112123.4593280755,
  'node5_NET_lo-read-KB/s': 146.6264573903922,
  'node5_NET_lo-write-KB/s': 146.6264573903922,
  'streaming_num': np.inf,
  't': 1528662105.7891946,
  'anomaly_label': 0.11953234062354584},
 '10': {'node6_CPU_ALL_Idle%': 77.45259971813134,
  'node6_CPU_ALL_Sys%': 2.494301145446119,
  'node6_CPU_ALL_User%': 19.68404699072104,
  'node6_CPU_ALL_Wait%': 0.36595915742080715,
  'node6_MEM_active': 124357.7306905782,
  'node6_MEM_cached': 192693.72584773417,
  'node6_MEM_inactive': 140791.57819868904,
  'node6_MEM_memfree': 475873.7141870738,
  'node6_MEM_memtotal': 772475.0999999997,
  'node6_NET_em1-read-KB/s': 231.3463380721319,
  'node6_NET_em1-write-KB/s': 140.5011785514978,
  'node6_NET_ib0-read-KB/s': 236873.16303737124,
  'node6_NET_ib0-write-KB/s': 126165.69575967385,
  'node6_NET_lo-read-KB/s': 187.56539352837132,
  'node6_NET_lo-write-KB/s': 187.56539352837132,
  'node7_CPU_ALL_Idle%': 76.05148121147856,
  'node7_CPU_ALL_Sys%': 2.8285648012270053,
  'node7_CPU_ALL_User%': 20.579687189343232,
  'node7_CPU_ALL_Wait%': 0.5371311172755933,
  'node7_MEM_active': 96840.7985997368,
  'node7_MEM_cached': 158087.23969211252,
  'node7_MEM_inactive': 129369.02941215453,
  'node7_MEM_memfree': 521053.7316086458,
  'node7_MEM_memtotal': 772475.0999999997,
  'node7_NET_em1-read-KB/s': 240.9613739431753,
  'node7_NET_em1-write-KB/s': 328.685562803556,
  'node7_NET_ib0-read-KB/s': 243495.5278140178,
  'node7_NET_ib0-write-KB/s': 159406.58140745858,
  'node7_NET_lo-read-KB/s': 1520.6665536862238,
  'node7_NET_lo-write-KB/s': 1520.6665536862238,
  'node8_CPU_ALL_Idle%': 85.37848770658518,
  'node8_CPU_ALL_Sys%': 1.3911585798480708,
  'node8_CPU_ALL_User%': 12.823701363202058,
  'node8_CPU_ALL_Wait%': 0.4012752230221272,
  'node8_MEM_active': 60664.19369861976,
  'node8_MEM_cached': 136233.17269717235,
  'node8_MEM_inactive': 109987.92886090798,
  'node8_MEM_memfree': 579733.9631121875,
  'node8_MEM_memtotal': 772475.0999999999,
  'node8_NET_em1-read-KB/s': 97.76001400096492,
  'node8_NET_em1-write-KB/s': 82.4266945424617,
  'node8_NET_ib0-read-KB/s': 127296.34583896998,
  'node8_NET_ib0-write-KB/s': 90511.40582269861,
  'node8_NET_lo-read-KB/s': 1457.5338340885655,
  'node8_NET_lo-write-KB/s': 1457.5338340885655,
  'node5_CPU_ALL_Idle%': 79.99638241425053,
  'node5_CPU_ALL_Sys%': 1.876655296570021,
  'node5_CPU_ALL_User%': 17.70877581959447,
  'node5_CPU_ALL_Wait%': 0.41474701534963043,
  'node5_MEM_active': 94185.54662687134,
  'node5_MEM_cached': 132456.67734981998,
  'node5_MEM_inactive': 106488.83067652074,
  'node5_MEM_memfree': 552900.6541425051,
  'node5_MEM_memtotal': 772475.0999999997,
  'node5_NET_em1-read-KB/s': 129.14581106689408,
  'node5_NET_em1-write-KB/s': 149.52984745120335,
  'node5_NET_ib0-read-KB/s': 214376.41705514496,
  'node5_NET_ib0-write-KB/s': 113519.64156244078,
  'node5_NET_lo-read-KB/s': 139.00102899374642,
  'node5_NET_lo-write-KB/s': 139.00102899374642,
  'streaming_num': np.inf,
  't': 1528656718.4834943,
  'anomaly_label': 0.13366130951256822}}

def ranges(nums):
    nums = sorted(set(nums))
    gaps = [[s, e] for s, e in zip(nums, nums[1:]) if s+1 < e]
    edges = iter(nums[:1] + sum(gaps, []) + nums[-1:])
    return list(zip(edges, edges))


def check_graph(data, piece=2, THRESHOLD=None, col=None, LOSS_img=False):
    
    if LOSS_img == True:
        real = np.array(data['loss'])
        
        region = ranges(list(np.where(real >= THRESHOLD)[0]))
        
        l1 = real.shape[0]
            
        chunk = l1 // piece
        fig, axs = plt.subplots(piece, figsize=(30, 4 * piece))
        
        for i in range(piece):
            L = i * chunk
            R1 = min(L + chunk, l1)
            
            xticks = range(L, R1)
            
            if piece == 1:
                plt.plot(xticks, real[L:R1], label="Loss")
                for re in region:
                    plt.axvspan(re[0], re[1], facecolor='g', alpha=0.3)

            else:  
                axs[i].plot(xticks, real[L:R1], label="Loss")
                for re in region:
                    plt.axvspan(re[0], re[1], facecolor='g', alpha=0.3)
                
            if len(real[L:R1]) > 0:
                peak = np.max(real[L:R1])
                                
            if piece == 1:
                plt.axhline(y=THRESHOLD, color='r')
            else:
                axs[i].axhline(y=THRESHOLD, color='r')
        plt.legend()
        plt.show()
        
    else:
        real = np.array(data[col])
        loss = np.array(data['loss'])
    
        region = ranges(list(np.where(loss >= THRESHOLD)[0]))
        
        l1 = real.shape[0]
        
        chunk = l1 // piece
        fig, axs = plt.subplots(piece, figsize=(30, 4 * piece))
        
        for i in range(piece):
            L = i * chunk
            R1 = min(L + chunk, l1)
            R2 = min(L + chunk, l1)
            
            xticks = range(L, R1)
            
            if piece == 1:
                plt.plot(xticks, real[L:R1], label="Real")
                for re in region:
                    plt.axvspan(re[0], re[1], facecolor='g', alpha=0.3)

            else:  
                axs[i].plot(xticks, real[L:R1], label="Real")
                for re in region:
                    plt.axvspan(re[0], re[1], facecolor='g', alpha=0.3)
                
            if len(real[L:R1]) > 0:
                peak = np.max(real[L:R1])
            plt.title('{}'.format(col))
                    
        plt.legend()
        plt.show()
    

def plot_history(history, idx, config):
    # plt.figure(figsize=(12,10))
    losses1 = history['valid_loss1']
    losses2 = history['valid_loss2']
    plt.plot(losses1, '-x', label="AE1 loss")
    plt.plot(losses2, '-x', label="AE2 loss")
    plt.xlabel('epoch')
    plt.ylabel('loss')
    plt.axvline(x=idx, color='r', linestyle='--')
    plt.legend()
    plt.title('Losses vs. No. of epochs')
    plt.grid()
    plt.savefig(config['model_save_name'] + ".png")
    plt.show()
    

class CustomDataset(Dataset):
    def __init__(self, data):
        super(CustomDataset, self).__init__()
        self.data = data

    def __len__(self):
        return len(self.data)

    def __getitem__(self, idx):
        record = self.data.iloc[idx]
        return record


class BucketBatchingSampler(Sampler):
    def __init__(self, data_source: Dataset, config: None):
        super(BucketBatchingSampler, self).__init__(data_source)
        self.data_source = data_source
        self.config = config      

        ids = list(range(len(self.data_source)))
        self.bins = [ids[i:i + self.config['batch_size']] for i in range(0, len(ids), self.config['batch_size'])]

    def __iter__(self):
        for ids in self.bins:
            yield ids

    def __len__(self):
        return len(self.bins)


class Custom_collate_fn(object):
    def __init__(self, config):
        self.config = config
    
    def __call__(self, batch):

        batch_input = batch[0][self.config['explanatory_col']]
        # batch_target = batch[0][self.config['target_col']]

        windows_input = batch_input.values[np.arange(self.config['window_size'])[None, :] + np.arange(batch_input.shape[0]-self.config['window_size']+1)[:, None]]
        # windows_target = batch_target.values[np.arange(self.config['window_size'])[None, :] + np.arange(batch_target.shape[0]-self.config['window_size']+1)[:, None]]

        torch_input = torch.from_numpy(windows_input).float().view(([windows_input.shape[0], self.config['input_window_size']]))
        # torch_target = torch.from_numpy(windows_target).float().view(([windows_target.shape[0], self.config['target_window_size']]))
        
        return torch_input#, torch_target


class EarlyStopping(object):
    def __init__(self, mode='min', min_delta=0, patience=10, percentage=False):
        self.mode = mode
        self.min_delta = min_delta
        self.patience = patience
        self.best = None
        self.num_bad_epochs = 0
        self.is_better = None
        self._init_is_better(mode, min_delta, percentage)

        if patience == 0:
            self.is_better = lambda a, b: True
            self.step = lambda a: False

    def step(self, metrics):
        if self.best is None:
            self.best = metrics
            return False

        if torch.isnan(metrics):
            return True

        if self.is_better(metrics, self.best):
            self.num_bad_epochs = 0
            self.best = metrics
        else:
            self.num_bad_epochs += 1

        if self.num_bad_epochs >= self.patience:
            return True

        return False

    def _init_is_better(self, mode, min_delta, percentage):
        if mode not in {'min', 'max'}:
            raise ValueError('mode ' + mode + ' is unknown!')
        if not percentage:
            if mode == 'min':
                self.is_better = lambda a, best: a < best - min_delta
            if mode == 'max':
                self.is_better = lambda a, best: a > best + min_delta
        else:
            if mode == 'min':
                self.is_better = lambda a, best: a < best - (
                            best * min_delta / 100)
            if mode == 'max':
                self.is_better = lambda a, best: a > best + (
                            best * min_delta / 100)


class CosineAnnealingWarmUpRestarts(_LRScheduler):
    def __init__(self, optimizer, T_0, T_mult=1, eta_max=0.1, T_up=0, gamma=1., last_epoch=-1):
        if T_0 <= 0 or not isinstance(T_0, int):
            raise ValueError("Expected positive integer T_0, but got {}".format(T_0))
        if T_mult < 1 or not isinstance(T_mult, int):
            raise ValueError("Expected integer T_mult >= 1, but got {}".format(T_mult))
        if T_up < 0 or not isinstance(T_up, int):
            raise ValueError("Expected positive integer T_up, but got {}".format(T_up))
        self.T_0 = T_0
        self.T_mult = T_mult
        self.base_eta_max = eta_max
        self.eta_max = eta_max
        self.T_up = T_up
        self.T_i = T_0
        self.gamma = gamma
        self.cycle = 0
        self.T_cur = last_epoch
        super(CosineAnnealingWarmUpRestarts, self).__init__(optimizer, last_epoch)
    
    def get_lr(self):
        if self.T_cur == -1:
            return self.base_lrs
        elif self.T_cur < self.T_up:
            return [(self.eta_max - base_lr)*self.T_cur / self.T_up + base_lr for base_lr in self.base_lrs]
        else:
            return [base_lr + (self.eta_max - base_lr) * (1 + math.cos(math.pi * (self.T_cur-self.T_up) / (self.T_i - self.T_up))) / 2
                    for base_lr in self.base_lrs]

    def step(self, epoch=None):
        if epoch is None:
            epoch = self.last_epoch + 1
            self.T_cur = self.T_cur + 1
            if self.T_cur >= self.T_i:
                self.cycle += 1
                self.T_cur = self.T_cur - self.T_i
                self.T_i = (self.T_i - self.T_up) * self.T_mult + self.T_up
        else:
            if epoch >= self.T_0:
                if self.T_mult == 1:
                    self.T_cur = epoch % self.T_0
                    self.cycle = epoch // self.T_0
                else:
                    n = int(math.log((epoch / self.T_0 * (self.T_mult - 1) + 1), self.T_mult))
                    self.cycle = n
                    self.T_cur = epoch - self.T_0 * (self.T_mult ** n - 1) / (self.T_mult - 1)
                    self.T_i = self.T_0 * self.T_mult ** (n)
            else:
                self.T_i = self.T_0
                self.T_cur = epoch
                
        self.eta_max = self.base_eta_max * (self.gamma**self.cycle)
        self.last_epoch = math.floor(epoch)
        for param_group, lr in zip(self.optimizer.param_groups, self.get_lr()):
            param_group['lr'] = lr

def to_device(data, device):
    """Move tensor(s) to chosen device"""
    if isinstance(data, (list,tuple)):
        return [to_device(x, device) for x in data]
    return data.to(device, non_blocking=True)


def criterion(real, w1, w2, w3, n):
    loss1 = 1/n*torch.mean((real-w1)**2) + (1-1/n)*torch.mean((real-w3)**2)
    loss2 = 1/n*torch.mean((real-w2)**2) - (1-1/n)*torch.mean((real-w3)**2)

    return loss1, loss2

# cyclical embedding
def dummy_and_add_feature(x):
    second = int(x.split(" ")[-1].split(":")[2])
    minute = int(x.split(" ")[-1].split(":")[1])
    hour = int(x.split(" ")[-1].split(":")[0])
    day = int(x.split(" ")[0].split("-")[-1])
    month = int(x.split(" ")[0].split("-")[-2])
        
    sin_second = np.sin((2*np.pi*second)/(60))
    cos_second = np.cos((2*np.pi*second)/(60))
    sin_minute = np.sin((2*np.pi*minute*60)/(60*60))
    cos_minute = np.cos((2*np.pi*minute*60)/(60*60))
    sin_hour = np.sin((2*np.pi*hour*60*60)/(24*60*60))
    cos_hour = np.cos((2*np.pi*hour*60*60)/(24*60*60))
    sin_day = np.sin((2*np.pi*day*24*60*60)/(31*24*60*60))
    cos_day = np.cos((2*np.pi*day*24*60*60)/(31*24*60*60))
    sin_month = np.sin((2*np.pi*month*31*24*60*60)/(12*31*24*60*60))
    cos_month = np.cos((2*np.pi*month*31*24*60*60)/(12*31*24*60*60))
    
    return sin_second, cos_second, sin_minute, cos_minute, sin_hour, cos_hour, sin_day, cos_day, sin_month, cos_month
